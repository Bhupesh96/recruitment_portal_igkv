<app-header></app-header>

<!-- Dashboard Header -->
<div
  class="relative bg-gradient-to-r from-indigo-700 via-indigo-600 to-indigo-500 text-white shadow-md pb-16"
>
  <div
    class="max-w-7xl mx-auto px-6 py-6 flex flex-col sm:flex-row sm:items-center sm:justify-between"
  >
    <div>
      <h1 class="text-2xl font-bold tracking-wide">Screening Dashboard</h1>
      <p class="text-sm text-indigo-100 mt-1">
        Monitor candidate status and progress in real-time
      </p>
    </div>

    <div class="flex gap-2 mt-3 sm:mt-0">
      <button
        class="px-4 py-2 bg-white/10 hover:bg-white/20 border border-white/20 rounded-lg text-sm font-medium transition-all duration-200"
      >
        Refresh
      </button>
      <button
        class="px-4 py-2 bg-white text-indigo-700 font-medium rounded-lg shadow hover:shadow-md hover:bg-indigo-50 transition-all duration-200"
      >
        Export Report
      </button>
    </div>
  </div>
</div>

<!-- ⚙️ Filter Section (Now immediately under header) -->
<div class="max-w-7xl mx-auto -mt-8 px-4">
  <div
    class="bg-white/80 backdrop-blur-md border border-gray-200 shadow-xl rounded-2xl p-5 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5"
  >
    <!-- Department -->
    <div class="flex flex-col">
      <label class="text-sm font-medium text-gray-700 mb-1">Department</label>
      <select
        [(ngModel)]="selected.department"
        class="rounded-xl border-gray-300 bg-white/70 text-gray-800 shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-sm p-2.5"
      >
        <option value="">All</option>
        <option *ngFor="let d of departments" [value]="d">{{ d }}</option>
      </select>
    </div>

    <!-- Post -->
    <div class="flex flex-col">
      <label class="text-sm font-medium text-gray-700 mb-1">Post</label>
      <select
        [(ngModel)]="selected.post"
        class="rounded-xl border-gray-300 bg-white/70 text-gray-800 shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-sm p-2.5"
      >
        <option value="">All</option>
        <option *ngFor="let p of posts" [value]="p">{{ p }}</option>
      </select>
    </div>

    <!-- Date Range -->
    <div class="flex flex-col">
      <label class="text-sm font-medium text-gray-700 mb-1">Date Range</label>
      <select
        [(ngModel)]="selected.dateRange"
        class="rounded-xl border-gray-300 bg-white/70 text-gray-800 shadow-sm focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-sm p-2.5"
      >
        <option value="">All</option>
        <option *ngFor="let dr of dateRanges" [value]="dr">{{ dr }}</option>
      </select>
    </div>
  </div>
</div>

<!-- 🔢 Status Bar (Now below filters) -->
<div class="max-w-7xl mx-auto mt-8 px-4">
  <div
    class="backdrop-blur-md bg-white/80 border border-gray-200 rounded-2xl p-4 flex justify-around shadow-lg"
  >
    <div
      (click)="filterByStatus('')"
      [ngClass]="{ 'bg-white/30 rounded-lg': selected.status === '' }"
      class="flex-1 text-center hover:bg-white/30 transition-all p-2 cursor-pointer"
    >
      <p class="text-indigo-600 uppercase text-xs font-semibold">Total</p>
      <p class="text-lg font-bold text-gray-900">{{ stats.total }}</p>
    </div>
    <div
      (click)="filterByStatus('Pending')"
      [ngClass]="{ 'bg-white/30 rounded-lg': selected.status === 'Pending' }"
      class="flex-1 text-center hover:bg-white/30 transition-all p-2 cursor-pointer"
    >
      <p class="text-yellow-500 uppercase text-xs font-semibold">Pending</p>
      <p class="text-lg font-bold">{{ stats.pending }}</p>
    </div>
    <div
      (click)="filterByStatus('Selected')"
      [ngClass]="{ 'bg-white/30 rounded-lg': selected.status === 'Selected' }"
      class="flex-1 text-center hover:bg-white/30 transition-all p-2 cursor-pointer"
    >
      <p class="text-green-500 uppercase text-xs font-semibold">Selected</p>
      <p class="text-lg font-bold">{{ stats.selected }}</p>
    </div>
    <div
      (click)="filterByStatus('Rejected')"
      [ngClass]="{ 'bg-white/30 rounded-lg': selected.status === 'Rejected' }"
      class="flex-1 text-center hover:bg-white/30 transition-all p-2 cursor-pointer"
    >
      <p class="text-red-500 uppercase text-xs font-semibold">Rejected</p>
      <p class="text-lg font-bold">{{ stats.rejected }}</p>
    </div>
  </div>
</div>

<!-- Candidate List -->
<div class="max-w-7xl mx-auto mt-8 px-4 space-y-5 pb-12">
  <div
    *ngFor="let c of filteredCandidates; let i = index"
    class="bg-white rounded-2xl shadow-lg border border-gray-100 hover:border-indigo-300 hover:shadow-indigo-100 transition-all duration-300 overflow-hidden"
  >
    <div
      class="flex justify-between items-center p-5 cursor-pointer"
      (click)="toggleExpand(i)"
    >
      <div>
        <h3 class="text-lg font-semibold text-gray-900">{{ c.name }}</h3>
        <p class="text-sm text-gray-500 mt-1">
          <span class="text-indigo-600 font-medium">{{ c.department }}</span> •
          {{ c.post }} •
          <span
            [ngClass]="{
              'text-yellow-500': c.status === 'Pending',
              'text-blue-500': c.status === 'Reviewed',
              'text-green-600': c.status === 'Selected',
              'text-red-500': c.status === 'Rejected'
            }"
            >{{ c.status }}</span
          >
        </p>
      </div>
      <div
        class="w-9 h-9 flex items-center justify-center rounded-full bg-indigo-50 text-indigo-600 shadow-sm transform transition-transform duration-300"
        [ngClass]="{ 'rotate-180': expandedIndex === i }"
      >
        ▼
      </div>
    </div>

    <div
      *ngIf="expandedIndex === i"
      class="bg-gradient-to-r from-indigo-50 to-purple-50 px-6 py-4 border-t"
    >
      <p class="text-gray-700 text-sm leading-relaxed mb-4">{{ c.details }}</p>
      <div class="flex gap-3">
        <button
          class="px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white text-sm font-medium rounded-lg shadow-md transition"
        >
          View Profile
        </button>
        <button
          class="px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 text-sm font-medium rounded-lg shadow-md transition"
        >
          Send Reminder
        </button>
      </div>
    </div>
  </div>

  <div
    *ngIf="filteredCandidates.length === 0"
    class="text-center py-16 bg-white rounded-2xl shadow-inner text-gray-500"
  >
    <p class="text-lg font-medium mb-2">No candidates found</p>
    <p class="text-sm opacity-70">Try adjusting your filters above.</p>
  </div>
</div>
