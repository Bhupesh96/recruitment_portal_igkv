<div class="min-h-screen flex items-center justify-center">
  <div class="w-full bg-white border border-gray-100 overflow-hidden">
    <!-- Header Section -->
    <div class="p-8 text-white">
      <div
        *ngIf="formData[1]"
        class="flex flex-col md:flex-row gap-8 items-center"
      >
        <div class="flex-grow">
          <h3 class="text-4xl font-extrabold tracking-tight">
            {{ formData[1]["Salutation_E_Name"] }}
            {{ formData[1]["Applicant_First_Name_E"] }}
            {{ formData[1]["Applicant_Middle_Name_E"] }}
            {{ formData[1]["Applicant_Last_Name_E"] }}
          </h3>
          <p class="text-gray-800 font-mono text-lg mt-3">
            Registration No:
            <span class="font-semibold text-gray-700">{{
              formData[1]["registration_no"]
            }}</span>
          </p>
        </div>
        <div class="flex-shrink-0 flex flex-col gap-6 items-center">
          <div *ngIf="formData[1]['candidate_photo']">
            <img
              [src]="getFileUrl(formData[1]['candidate_photo'])"
              alt="Applicant Photo"
              class="w-40 h-48 object-cover border-1 border-gray-300 transform hover:scale-105 transition-transform duration-300"
            />
          </div>
          <div *ngIf="formData[1]['candidate_signature']">
            <img
              [src]="getFileUrl(formData[1]['candidate_signature'])"
              alt="Applicant Signature"
              class="w-52 h-24 object-contain border-1 border-gray-300 p-2 bg-white"
            />
          </div>
        </div>
      </div>
    </div>

    <!-- Content Sections -->
    <div class="p-8 space-y-10">
      <!-- Personal Information Section -->
      <div *ngIf="formData[1]" class="p-6 border border-gray-200">
        <h4
          class="text-2xl font-bold text-indigo-800 flex items-center gap-3 mb-6"
        >
          <svg
            class="h-7 w-7 text-indigo-600"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
            />
          </svg>
          Personal Information
        </h4>
        <div
          class="grid md:grid-cols-3 gap-x-8 gap-y-6 text-sm pt-4 border-t border-gray-200"
        >
          <ng-container *ngFor="let key of getFormDataKeys(formData[1])">
            <div
              *ngIf="
                !personalInfoExcludeKeys.has(key) &&
                formData[1][key] &&
                key !== 'languages' &&
                !key.startsWith('question_') &&
                !key.startsWith('condition_') &&
                key !== 'additionalInfoDetails'
              "
            >
              <p
                class="text-xs font-semibold text-gray-500 uppercase tracking-widest mb-1"
              >
                {{ formatKey(key) }}
              </p>
              <p class="text-gray-900 font-medium break-words">
                {{ formatValue(formData[1][key]) }}
              </p>
            </div>
          </ng-container>
        </div>

        <div class="mt-8">
          <h6
            class="text-lg font-semibold text-gray-800 mb-3 flex items-center gap-3"
          >
            <svg
              class="h-6 w-6 text-indigo-600"
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h7.5"
              />
            </svg>
            Permanent Address
          </h6>
          <div
            class="grid md:grid-cols-3 gap-x-8 gap-y-6 text-sm pt-4 border-t border-gray-200"
          >
            <div class="md:col-span-3">
              <p
                class="text-xs font-semibold text-gray-500 uppercase tracking-widest mb-1"
              >
                Address
              </p>
              <p class="text-gray-900 font-medium">
                {{ formatValue(formData[1]["Permanent_Address1"]) }}
              </p>
            </div>
            <div>
              <p
                class="text-xs font-semibold text-gray-500 uppercase tracking-widest mb-1"
              >
                City
              </p>
              <p class="text-gray-900 font-medium">
                {{ formatValue(formData[1]["Permanent_City"]) }}
              </p>
            </div>
            <div>
              <p
                class="text-xs font-semibold text-gray-500 uppercase tracking-widest mb-1"
              >
                Pin Code
              </p>
              <p class="text-gray-900 font-medium">
                {{ formatValue(formData[1]["Permanent_Pin_Code"]) }}
              </p>
            </div>
            <div>
              <p
                class="text-xs font-semibold text-gray-500 uppercase tracking-widest mb-1"
              >
                Country
              </p>
              <p class="text-gray-900 font-medium">
                {{ formatValue(formData[1]["Permanent_Country_Name"]) }}
              </p>
            </div>
            <div>
              <p
                class="text-xs font-semibold text-gray-500 uppercase tracking-widest mb-1"
              >
                State
              </p>
              <p class="text-gray-900 font-medium">
                {{ formatValue(formData[1]["Permanent_State_Name"]) }}
              </p>
            </div>
            <div>
              <p
                class="text-xs font-semibold text-gray-500 uppercase tracking-widest mb-1"
              >
                District
              </p>
              <p class="text-gray-900 font-medium">
                {{ formatValue(formData[1]["Permanent_District_Name"]) }}
              </p>
            </div>
          </div>
        </div>

        <div class="mt-8">
          <h6
            class="text-lg font-semibold text-gray-800 mb-3 flex items-center gap-3"
          >
            <svg
              class="h-6 w-6 text-indigo-600"
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75"
              />
            </svg>
            Present Address
          </h6>
          <div
            class="grid md:grid-cols-3 gap-x-8 gap-y-6 text-sm pt-4 border-t border-gray-200"
          >
            <div class="md:col-span-3">
              <p
                class="text-xs font-semibold text-gray-500 uppercase tracking-widest mb-1"
              >
                Address
              </p>
              <p class="text-gray-900 font-medium">
                {{ formatValue(formData[1]["Current_Address1"]) }}
              </p>
            </div>
            <div>
              <p
                class="text-xs font-semibold text-gray-500 uppercase tracking-widest mb-1"
              >
                City
              </p>
              <p class="text-gray-900 font-medium">
                {{ formatValue(formData[1]["Current_City"]) }}
              </p>
            </div>
            <div>
              <p
                class="text-xs font-semibold text-gray-500 uppercase tracking-widest mb-1"
              >
                Pin Code
              </p>
              <p class="text-gray-900 font-medium">
                {{ formatValue(formData[1]["Current_Pin_Code"]) }}
              </p>
            </div>
            <div>
              <p
                class="text-xs font-semibold text-gray-500 uppercase tracking-widest mb-1"
              >
                Country
              </p>
              <p class="text-gray-900 font-medium">
                {{ formatValue(formData[1]["Current_Country_Name"]) }}
              </p>
            </div>
            <div>
              <p
                class="text-xs font-semibold text-gray-500 uppercase tracking-widest mb-1"
              >
                State
              </p>
              <p class="text-gray-900 font-medium">
                {{ formatValue(formData[1]["Current_State_Name"]) }}
              </p>
            </div>
            <div>
              <p
                class="text-xs font-semibold text-gray-500 uppercase tracking-widest mb-1"
              >
                District
              </p>
              <p class="text-gray-900 font-medium">
                {{ formatValue(formData[1]["Current_District_Name"]) }}
              </p>
            </div>
          </div>
        </div>
        <div class="mt-8">
          <h6
            class="text-lg font-semibold text-gray-800 mb-3 flex items-center gap-3"
          >
            <svg
              class="h-6 w-6 text-indigo-600"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"
              />
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"
              />
            </svg>
            Birth Place
          </h6>
          <div
            class="grid md:grid-cols-3 gap-x-8 gap-y-6 text-sm pt-4 border-t border-gray-200"
          >
            <div>
              <p
                class="text-xs font-semibold text-gray-500 uppercase tracking-widest mb-1"
              >
                Place
              </p>
              <p class="text-gray-900 font-medium">
                {{ formatValue(formData[1]["Birth_Place"]) }}
              </p>
            </div>
            <div>
              <p
                class="text-xs font-semibold text-gray-500 uppercase tracking-widest mb-1"
              >
                Country
              </p>
              <p class="text-gray-900 font-medium">
                {{ formatValue(formData[1]["Birth_Country_Name"]) }}
              </p>
            </div>
            <div>
              <p
                class="text-xs font-semibold text-gray-500 uppercase tracking-widest mb-1"
              >
                State
              </p>
              <p class="text-gray-900 font-medium">
                {{ formatValue(formData[1]["Birth_State_Name"]) }}
              </p>
            </div>
            <div>
              <p
                class="text-xs font-semibold text-gray-500 uppercase tracking-widest mb-1"
              >
                District
              </p>
              <p class="text-gray-900 font-medium">
                {{ formatValue(formData[1]["Birth_District_Name"]) }}
              </p>
            </div>
          </div>
        </div>
        <div
          *ngIf="
            formData[1]['additionalInfoDetails'] &&
            formData[1]['additionalInfoDetails'].length > 0
          "
          class="mt-8"
        >
          <h6
            class="text-lg font-semibold text-gray-800 mb-3 flex items-center gap-3"
          >
            <svg
              class="h-6 w-6 text-indigo-600"
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25zM6.75 12h.008v.008H6.75V12z"
              />
            </svg>
            Additional Information
          </h6>
          <div
            class="grid md:grid-cols-3 gap-x-8 gap-y-6 text-sm pt-4 border-t border-gray-200"
          >
            <ng-container
              *ngFor="let item of formData[1]['additionalInfoDetails']"
            >
              <div
                class="transform hover:-translate-y-1 transition-transform duration-200"
              >
                <p
                  class="text-xs font-semibold text-gray-500 uppercase tracking-widest mb-1"
                >
                  {{ item.question }}
                </p>

                <ng-container
                  *ngIf="item.answer === 'File Uploaded'; else standardInfo"
                >
                  <span
                    class="inline-block bg-blue-100 text-blue-800 text-xs font-semibold px-3 py-1 rounded-full"
                  >
                    ✓ File Uploaded
                  </span>
                </ng-container>

                <ng-template #standardInfo>
                  <p class="text-gray-900 font-medium break-words">
                    {{ formatValue(item.answer) }}
                  </p>
                </ng-template>
              </div>
            </ng-container>
          </div>
        </div>
        <div
          *ngIf="
            formData[1]['languages'] && formData[1]['languages'].length > 0
          "
          class="mt-8"
        >
          <h6
            class="text-lg font-semibold text-gray-800 mb-3 flex items-center gap-3"
          >
            <svg
              class="h-6 w-6 text-indigo-600"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"
              />
            </svg>
            Language Proficiency
          </h6>
          <div class="overflow-x-auto ring-1 ring-gray-200">
            <table class="min-w-full text-sm">
              <thead class="bg-blue-700 text-white uppercase text-xs">
                <tr>
                  <th class="px-6 py-3 border-r border-gray-200 font-semibold">
                    Language
                  </th>
                  <th class="px-6 py-3 border-r border-gray-200 font-semibold">
                    Type
                  </th>
                  <th class="px-6 py-3 font-semibold">Skill</th>
                </tr>
              </thead>
              <tbody>
                <tr
                  *ngFor="let lang of formData[1]['languages']"
                  class="bg-white hover:bg-indigo-50 transition-colors duration-200 border-t border-gray-200"
                >
                  <td class="px-6 py-3 border-r border-gray-200">
                    {{ lang.language_name }}
                  </td>
                  <td class="px-6 py-3 border-r border-gray-200">
                    {{ lang.language_type | titlecase }}
                  </td>
                  <td class="px-6 py-3">{{ lang.language_skill }}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Other Sections -->
      <ng-container *ngFor="let i of [2, 3, 4, 5, 6]">
        <div *ngIf="formData[i]" class="bg-white p-6 border border-gray-200">
          <h4
            class="text-2xl font-bold text-indigo-800 flex items-center gap-3 mb-6"
          >
            <ng-container [ngSwitch]="i">
              <svg
                *ngSwitchCase="2"
                class="h-7 w-7 text-indigo-600"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"
                />
              </svg>
              <svg
                *ngSwitchCase="3"
                class="h-7 w-7 text-indigo-600"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"
                />
              </svg>
              <svg
                *ngSwitchCase="4"
                class="h-7 w-7 text-indigo-600"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
                />
              </svg>
              <svg
                *ngSwitchCase="5"
                class="h-7 w-7 text-indigo-600"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"
                />
              </svg>
              <svg
                *ngSwitchCase="6"
                class="h-7 w-7 text-indigo-600"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.783-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"
                />
              </svg>
            </ng-container>
            <span>{{
              (formData[i]["heading"] &&
                formData[i]["heading"]["score_field_title_name"]) ||
                steps[i - 1]
            }}</span>
          </h4>

          <div class="border-t border-gray-200 pt-4">
            <ng-container [ngSwitch]="i">
              <ng-container *ngSwitchCase="2">
                <div class="space-y-8">
                  <ng-container
                    *ngFor="let key of getFormDataKeys(formData[i])"
                  >
                    <div
                      *ngIf="
                        key.startsWith('qualifications') &&
                        formData[i][key]?.length > 0
                      "
                    >
                      <h6 class="font-semibold text-gray-800 mb-3 text-lg">
                        {{
                          formData[i]["subheadings"][
                            key.replace("qualifications", "")
                          ]["score_field_title_name"]
                        }}
                      </h6>
                      <div class="overflow-x-auto ring-1 ring-gray-200">
                        <table class="min-w-full text-sm">
                          <thead
                            class="bg-blue-700 text-white uppercase text-xs"
                          >
                            <tr>
                              <th
                                *ngFor="
                                  let headerKey of getDisplayableKeys(
                                    formData[i][key][0]
                                  )
                                "
                                class="px-6 py-3 text-left font-semibold"
                              >
                                {{ formatKey(headerKey) }}
                              </th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr
                              *ngFor="let item of formData[i][key]"
                              class="bg-white hover:bg-indigo-50 transition-colors duration-200 border-t border-gray-200"
                            >
                              <td
                                *ngFor="let dataKey of getDisplayableKeys(item)"
                                class="px-6 py-3"
                              >
                                <ng-container
                                  *ngIf="
                                    dataKey
                                      .toLowerCase()
                                      .includes('certificate') ||
                                    dataKey
                                      .toLowerCase()
                                      .includes('marksheet') ||
                                    dataKey.toLowerCase().includes('formula')
                                  "
                                >
                                  <span
                                    *ngIf="
                                      checkFilesForSubheading(formData[i], key)
                                    "
                                    class="inline-block bg-blue-100 text-blue-800 text-xs font-semibold px-3 py-1 rounded-full"
                                    >✓ File Uploaded</span
                                  >
                                  <span
                                    *ngIf="
                                      !checkFilesForSubheading(formData[i], key)
                                    "
                                    class="text-gray-400"
                                    >Not Uploaded</span
                                  >
                                </ng-container>
                                <ng-container
                                  *ngIf="
                                    !(
                                      dataKey
                                        .toLowerCase()
                                        .includes('certificate') ||
                                      dataKey
                                        .toLowerCase()
                                        .includes('marksheet') ||
                                      dataKey.toLowerCase().includes('formula')
                                    )
                                  "
                                >
                                  {{ formatValue(item[dataKey]) }}
                                </ng-container>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </ng-container>
                </div>
              </ng-container>

              <ng-container *ngSwitchCase="5">
                <div class="space-y-8">
                  <ng-container
                    *ngFor="let key of getFormDataKeys(formData[i])"
                  >
                    <div
                      *ngIf="
                        isExperienceKey(key) && formData[i][key]?.length > 0
                      "
                    >
                      <h6 class="font-semibold text-gray-800 mb-3 text-lg">
                        {{
                          formData[i]["subheadings"][key][
                            "score_field_title_name"
                          ]
                        }}
                      </h6>
                      <div class="overflow-x-auto ring-1 ring-gray-200">
                        <table class="min-w-full text-sm">
                          <thead
                            class="bg-blue-700 text-white uppercase text-xs"
                          >
                            <tr>
                              <th
                                *ngFor="
                                  let headerKey of getDisplayableKeys(
                                    formData[i][key][0]
                                  )
                                "
                                class="px-6 py-3 text-left font-semibold"
                              >
                                {{ formatKey(headerKey) }}
                              </th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr
                              *ngFor="let item of formData[i][key]"
                              class="bg-white hover:bg-indigo-50 transition-colors duration-200 border-t border-gray-200"
                            >
                              <td
                                *ngFor="let dataKey of getDisplayableKeys(item)"
                                class="px-6 py-3"
                              >
                                <ng-container
                                  *ngIf="
                                    dataKey.toLowerCase().includes('document')
                                  "
                                >
                                  <span
                                    *ngIf="
                                      checkFilesForSubheading(formData[i], key)
                                    "
                                    class="inline-block bg-blue-100 text-blue-800 text-xs font-semibold px-3 py-1 rounded-full"
                                    >✓ File Uploaded</span
                                  >
                                  <span
                                    *ngIf="
                                      !checkFilesForSubheading(formData[i], key)
                                    "
                                    class="text-gray-400"
                                    >Not Uploaded</span
                                  >
                                </ng-container>
                                <ng-container
                                  *ngIf="
                                    !dataKey.toLowerCase().includes('document')
                                  "
                                >
                                  {{ formatValue(item[dataKey]) }}
                                </ng-container>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </ng-container>
                </div>
              </ng-container>

              <ng-container *ngSwitchCase="3">
                <ng-container
                  [ngTemplateOutlet]="detailsTable"
                  [ngTemplateOutletContext]="{ stepIndex: i }"
                ></ng-container>
              </ng-container>
              <ng-container *ngSwitchCase="4">
                <ng-container
                  [ngTemplateOutlet]="detailsTable"
                  [ngTemplateOutletContext]="{ stepIndex: i }"
                ></ng-container>
              </ng-container>
              <ng-container *ngSwitchCase="6">
                <ng-container
                  [ngTemplateOutlet]="detailsTable"
                  [ngTemplateOutletContext]="{ stepIndex: i }"
                ></ng-container>
              </ng-container>
            </ng-container>
          </div>
        </div>
      </ng-container>
    </div>
  </div>
</div>

<ng-template #detailsTable let-stepIndex="stepIndex">
  <div class="space-y-8">
    <div
      *ngFor="
        let subheadKey of getFormDataKeys(formData[stepIndex]['subheadings'])
      "
    >
      <h6 class="font-semibold text-gray-800 mb-3 text-lg">
        {{
          formData[stepIndex]["subheadings"][subheadKey]["score_field_name_e"]
        }}
      </h6>
      <div class="overflow-x-auto ring-1 ring-gray-200">
        <table class="min-w-full text-sm">
          <ng-container
            *ngIf="formData[stepIndex]?.['details']?.length > 0; else noDataTable"
          >
            <thead class="bg-blue-700 text-white uppercase text-xs">
              <tr>
                <th
                  *ngFor="
                    let headerKey of getDisplayableKeys(
                      formData[stepIndex]['details'][0]
                    )
                  "
                  class="px-6 py-3 text-left font-semibold"
                >
                  {{ formatKey(headerKey) }}
                </th>
              </tr>
            </thead>
            <tbody>
              <ng-container
                *ngFor="let detail of formData[stepIndex]['details']"
              >
                <tr
                  *ngIf="
                    detailBelongsToSubheading(
                      detail,
                      formData[stepIndex]['subheadings'][subheadKey]['items']
                    )
                  "
                  class="bg-white hover:bg-indigo-50 transition-colors duration-200 border-t border-gray-200"
                >
                  <td
                    *ngFor="let dataKey of getDisplayableKeys(detail)"
                    class="px-6 py-3"
                  >
                    <ng-container
                      *ngIf="dataKey === 'type'; else standardCell"
                      >{{
                        getDetailItemName(stepIndex, detail[dataKey])
                      }}</ng-container
                    >
                    <ng-template #standardCell>
                      <span
                        *ngIf="isFileValue(detail[dataKey])"
                        class="inline-block bg-blue-100 text-blue-800 text-xs font-semibold px-3 py-1 rounded-full"
                        >✓ File Uploaded</span
                      >
                      <ng-container *ngIf="!isFileValue(detail[dataKey])">{{
                        formatValue(detail[dataKey])
                      }}</ng-container>
                    </ng-template>
                  </td>
                </tr>
              </ng-container>
            </tbody>
          </ng-container>

          <ng-template #noDataTable>
            <thead class="bg-blue-700 text-white uppercase text-xs">
              <tr>
                <th class="px-6 py-3 text-left font-semibold">Information</th>
              </tr>
            </thead>
            <tbody>
              <tr class="bg-white border-t border-gray-200">
                <td class="px-6 py-4 text-gray-500 italic">
                  — No data provided for this section.
                </td>
              </tr>
            </tbody>
          </ng-template>
        </table>
      </div>
    </div>
  </div>
</ng-template>
