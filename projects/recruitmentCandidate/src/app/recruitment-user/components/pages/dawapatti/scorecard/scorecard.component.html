<div
  id="scorecard-to-print"
  class="min-h-[calc(100vh-64px-64px)] flex flex-col items-center"
>
  <div class="w-full bg-white rounded-sm border border-gray-300 p-5 md:p-6">
    <!-- Header Section (PDF Version) -->
    <div
      style="
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        gap: 14px;
        width: 100%;
        margin-bottom: 6px;
      "
    >
      <img
        id="logo"
        src="igkv_logo.png"
        alt="IGKV Logo"
        style="
          width: 65px;
          height: 65px;
          object-fit: contain;
          flex-shrink: 0;
          margin: 0;
        "
      />
      <div style="display: flex; flex-direction: column; align-items: center">
        <h3
          style="
            font-size: 16px;
            font-weight: 700;
            color: #111827;
            margin: 0;
            line-height: 1.25;
            font-family: 'Roboto', Arial, sans-serif;
          "
        >
          Indira Gandhi Krishi Vishwavidyalaya, Raipur (C.G.) - 492012
        </h3>
        <h5
          style="
            font-size: 15px;
            font-weight: 600;
            margin: 2px 0 0;
            font-family: 'Noto Sans Devanagari', sans-serif;
            color: #111827;
            text-align: center;
          "
        >
          इंदिरा गांधी कृषि विश्वविद्यालय, रायपुर (छ.ग.) - ४९२०१२
        </h5>
      </div>
    </div>

    <div class="text-gray-700 text-base leading-relaxed font-light py-2">
      <div
        *ngIf="applicantData; else noApplicantData"
        style="
          display: flex;
          flex-direction: row;
          align-items: stretch;
          border: 1px solid #111;
          overflow: hidden;
          page-break-inside: avoid;
          width: 100%;
        "
      >
        <!-- Left: Applicant Details -->
        <div
          style="
            flex: 1;
            display: grid;
            grid-template-columns: 1fr 1fr;
            font-size: 12px;
            line-height: 1.2;
            padding: 4px 6px;
            border-right: 1px solid #111;
            box-sizing: border-box;
          "
        >
          <p style="margin: 0; padding: 1px 0">
            <strong>Registration No.:</strong>
            {{ applicantData.registration_no }}
          </p>
          <p style="margin: 0; padding: 1px 0">
            <strong>Registration Date:</strong> 28-10-2023
          </p>
          <p style="margin: 0; padding: 1px 0">
            <strong>Applicant Full Name:</strong> {{ fullNameE }}
          </p>
          <p style="margin: 0; padding: 1px 0">
            <strong>Date of Birth:</strong>
            {{ applicantData.DOB | date : "dd-MM-yyyy" }}
          </p>
          <p style="margin: 0; padding: 1px 0">
            <strong>Advertisement No.:</strong>
            {{ applicantData.advertisment_no }}
          </p>
          <p style="margin: 0; padding: 1px 0">
            <strong>Father’s Name:</strong>
            {{ applicantData.Applicant_Father_Name_E }}
          </p>
          <p *ngIf="applicantData.subject_id" style="margin: 0; padding: 1px 0">
            <strong>Subject:</strong> {{ subjectName }}
          </p>
          <p style="margin: 0; padding: 1px 0">
            <strong>Category:</strong> {{ applicantCategory }}
          </p>
        </div>

        <!-- Right: Photo Section -->
        <div
          style="
            width: 92px;
            min-width: 92px;
            background: #f9fafb;
            display: flex;
            align-items: center;
            justify-content: center;
            border-left: 1px solid #111;
            border-right: 1px solid #111;
            padding: 4px;
            box-sizing: border-box;
          "
        >
          <img
            *ngIf="applicantData.candidate_photo"
            [src]="getFileUrl(applicantData.candidate_photo)"
            alt="Applicant Photo"
            style="
              width: 82px;
              height: 102px;
              object-fit: cover;
              border: 1px solid #444;
              border-radius: 2px;
              background: white;
              box-sizing: border-box;
            "
          />
        </div>
      </div>

      <ng-template #noApplicantData>
        <p class="text-center text-gray-500 italic py-4">
          Loading applicant data...
        </p>
      </ng-template>

      <div class="mt-6 border-t border-gray-300 pt-3">
        <h5
          class="text-lg font-semibold text-gray-800 tracking-wide font-['Roboto'] text-center"
        >
          Candidate Scoring
        </h5>
        <div
          class="w-24 h-[2px] bg-gradient-to-r from-blue-500 to-blue-700 rounded-full mx-auto mt-1"
        ></div>
      </div>

      <div class="mt-4 overflow-x-auto">
        <table
          *ngIf="scoringTableData.length > 0; else noScoreData"
          class="w-full min-w-full border border-gray-300 text-left text-sm"
        >
          <thead class="bg-gray-100 border-b border-gray-300">
            <tr>
              <th
                scope="col"
                class="px-4 py-2 font-semibold text-gray-700 w-16"
              >
                Sno.
              </th>
              <th scope="col" class="px-4 py-2 font-semibold text-gray-700">
                Details
              </th>
              <th
                scope="col"
                class="px-4 py-2 font-semibold text-gray-700 w-32 text-center"
              >
                Max Marks
              </th>
              <th
                scope="col"
                class="px-4 py-2 font-semibold text-gray-700 w-32 text-center"
              >
                Obtained Marks
              </th>
            </tr>
          </thead>

          <tbody>
            <tr
              *ngFor="let item of scoringTableData; let i = index"
              class="border-b border-gray-300"
            >
              <td class="px-4 py-2 text-gray-700 font-semibold align-top">
                {{ i + 1 }}.
              </td>

              <td class="px-4 py-2 text-gray-700 align-top">
                <span class="font-semibold">{{
                  item?.score_field_title_name
                }}</span>

                <table
                  *ngIf="item.subHeadings.length > 0"
                  class="w-full mt-2 text-sm border border-gray-300"
                >
                  <thead class="bg-gray-100">
                    <tr class="text-left">
                      <th
                        class="px-2 py-1 border-b border-gray-300 font-semibold text-gray-600"
                      >
                        Sub-Item
                      </th>
                      <th
                        class="px-2 py-1 border-b border-gray-300 font-semibold text-gray-600 w-32 text-center"
                      >
                        Max Marks
                      </th>
                      <th
                        class="px-2 py-1 border-b border-gray-300 font-semibold text-gray-600 w-32 text-center"
                      >
                        Scoring by Committee
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr
                      *ngFor="let subItem of item.subHeadings"
                      class="hover:bg-gray-50"
                    >
                      <td class="px-2 py-1 border border-gray-200">
                        {{ subItem?.score_field_title_name }}
                      </td>
                      <td
                        class="px-2 py-1 border border-gray-200 w-32 text-center"
                      >
                        {{ subItem?.score_field_field_marks }}
                      </td>
                      <td
                        class="px-2 py-1 border border-gray-200 w-32 text-center font-medium text-blue-700"
                      >
                        {{ subItem?.score_field_calculated_value | number : "1.3-3" }}
                      </td>
                    </tr>
                  </tbody>
                </table>
              </td>

              <td
                class="px-4 py-2 text-gray-700 font-semibold align-top text-center"
              >
                {{ item?.score_field_field_marks }}
              </td>

              <td
                class="px-4 py-2 text-blue-800 font-bold align-top text-center"
              >
                {{ item.score_field_calculated_value | number : "1.3-3" }}
              </td>
            </tr>
          </tbody>
        </table>

        <ng-template #noScoreData>
          <p class="text-center text-gray-500 italic mt-4">
            Loading scoring data...
          </p>
        </ng-template>
      </div>
      <div
        *ngIf="applicantData && applicantData.Verification_Finalize_YN"
        class="mb-6 mt-3 ml-4"
      >
        <div class="flex items-center gap-2">
          <span class="text-base font-semibold text-gray-800"
            >Eligibility:</span
          >
          <span
            *ngIf="applicantData.Verification_Finalize_YN === 'Y'"
            class="px-3 py-0.5 rounded-full text-xm font-medium bg-green-100 text-green-800"
          >
            Eligible
          </span>
          <span
            *ngIf="applicantData.Verification_Finalize_YN === 'N'"
            class="px-3 py-0.5 rounded-full text-xm font-medium bg-red-100 text-red-800"
          >
            Not Eligible
          </span>
        </div>

        <div *ngIf="applicantData.Verified_Remark" class="mt-2">
          <span class="text-base font-semibold text-gray-800">Remark:</span>
          <p class="text-base text-gray-700 ml-2">
            {{ applicantData.Verified_Remark }}
          </p>
        </div>
      </div>
      <div class="mt-8 text-center border-t border-gray-300 pt-6">
        <h5
          class="text-lg font-semibold text-gray-800 tracking-wide font-['Roboto']"
        >
          MARKS GIVEN BY COMMITTEE / MAX. MARKS
        </h5>
        <div
          class="w-24 h-[2px] bg-gradient-to-r from-blue-500 to-blue-700 rounded-full mx-auto mt-1"
        ></div>
        <p class="text-3xl font-bold text-blue-800 mt-3">
          {{ totalObtainedMarks | number : "1.2-2" }} /
          {{ totalMaxMarks | number : "1.2-2" }}
        </p>
      </div>
    </div>
  </div>
</div>
<button
  (click)="downloadPDF()"
  style="
    position: fixed;
    bottom: 45px;
    right: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    background-color: #192440;
    color: #ffffff;
    font-weight: 600;
    font-size: 14px;
    border: none;
    border-radius: 9999px;
    padding: 12px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    cursor: pointer;
    overflow: hidden;
    z-index: 9999;
    transition: all 0.3s ease;
  "
  onmouseover="this.style.padding='12px 20px'; this.children[1].style.maxWidth='120px'; this.children[1].style.opacity='1';"
  onmouseout="this.style.padding='12px'; this.children[1].style.maxWidth='0px'; this.children[1].style.opacity='0';"
>
  <!-- Download Icon -->
  <svg
    xmlns="http://www.w3.org/2000/svg"
    fill="none"
    viewBox="0 0 24 24"
    stroke-width="2"
    stroke="currentColor"
    style="
      width: 20px;
      height: 20px;
      flex-shrink: 0;
      transition: transform 0.3s ease;
    "
  >
    <path
      stroke-linecap="round"
      stroke-linejoin="round"
      d="M12 4v12m0 0l-4-4m4 4l4-4M4 20h16"
    />
  </svg>

  <!-- Expanding Text -->
  <span
    style="
      max-width: 0;
      opacity: 0;
      white-space: nowrap;
      overflow: hidden;
      transition: all 0.3s ease;
    "
  >
    Download PDF
  </span>
</button>
